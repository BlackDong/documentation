## 关于报表设计的一点感想
一个基于spring boot 构建的, spring cloud 实现的, docker 容器化部署的, 前后端分离的, 分布式数据组装计算的, VUE渲染的 报表工具.
## 功能交互设计
### 报表数据展示流程
```mermaid
sequenceDiagram
participant 浏览器
participant 报表微服务
participant 报表定义微服务
participant 查询执行器微服务
participant 查询定义微服务
participant 数据源管理微服务
participant 数据仓库
浏览器->>+报表微服务: 发起报表查询请求
报表微服务->>+报表定义微服务: 报表定义是否存在?
alt 报表定义不存在
  报表定义微服务 -->>-报表微服务: 返回空
  报表微服务 -->> 浏览器: 显示错误信息
else 报表定义存在
  报表定义微服务 -->>-报表微服务: 返回定义信息
end
报表微服务 ->>报表微服务: 获得报表定义中的查询定义
报表微服务 ->>+ 查询执行器微服务: 执行查询
查询执行器微服务 ->>+ 查询定义微服务: 查询定义是否存在?
alt 查询定义不存在
  查询定义微服务 -->>-查询执行器微服务: 返回空
  查询执行器微服务 -->> 报表微服务: 错误信息
  报表微服务 -->> 浏览器: 显示错误信息
else 查询定义存在
  查询定义微服务 -->>-查询执行器微服务: 返回查询定义信息
end
查询执行器微服务 ->>查询执行器微服务: 获取数据源定义及组装查询语句
查询执行器微服务 ->>+ 数据源管理微服务: 数据源定义是否存在?
alt 数据源定义不存在
  数据源管理微服务 -->>- 查询执行器微服务: 返回空
  查询执行器微服务 -->> 报表微服务: 错误信息
  报表微服务 -->> 浏览器: 显示错误信息
else 数据源定义存在
  数据源管理微服务 -->> 查询执行器微服务: 返回数据源定义
end
查询执行器微服务 ->> 数据仓库: 测试数据库连接
alt 数据库连接失败
  查询执行器微服务 -->> 报表微服务: 数据库连接失败
  报表微服务 -->> 浏览器: 显示错误信息
else 数据库连接成功
  查询执行器微服务 ->> 查询执行器微服务: 建立数据库连接池
end
查询执行器微服务 ->>+ 数据仓库: 执行查询
数据仓库 -->>- 查询执行器微服务: 返回数据
查询执行器微服务 ->> 查询执行器微服务: 数据封装
查询执行器微服务 -->> 报表微服务: 返回结果
报表微服务 -->> 浏览器: 返回数据结果
浏览器 -->> 浏览器: 渲染数据
```

